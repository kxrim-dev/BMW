<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crazy Cars</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: black;
        }
        canvas {
            display: block;
            background: gray;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        let laneHeight = canvas.height / 3;
        let lanes = [laneHeight / 2, laneHeight * 1.5, laneHeight * 2.5];
        let player = { x: 200, y: lanes[1], width: 50, height: 80, lane: 1, speed: 2, maxSpeed: 15, minSpeed: 2, acceleration: 0.05 };
        let enemies = [];
        let score = 0;
        let gameOver = false;
        let cameraX = 0;
        let keys = {};

        function drawCar(x, y, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x - cameraX, y - 40, 50, 80);
        }

        function drawLanes() {
            ctx.strokeStyle = "white";
            ctx.lineWidth = 4;
            for (let i = 1; i < 3; i++) {
                let y = i * laneHeight;
                ctx.setLineDash([20, 20]);
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }

        function update() {
            if (gameOver) return;

            // Beschleunigung und VerzÃ¶gerung
            if (keys["w"] && player.speed < player.maxSpeed) {
                player.speed += player.acceleration;
            }
            if (keys["s"] && player.speed > player.minSpeed) {
                player.speed -= player.acceleration;
            }

            // Spurwechseln mit "A" und "D"
            if (keys["a"] && player.lane > 0) {
                player.lane--;
                player.y = lanes[player.lane];
            }
            if (keys["d"] && player.lane < lanes.length - 1) {
                player.lane++;
                player.y = lanes[player.lane];
            }

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawLanes();
            drawCar(player.x, player.y, "blue");

            // Gegner-Logik
            for (let i = 0; i < enemies.length; i++) {
                enemies[i].x -= player.speed;
                drawCar(enemies[i].x, enemies[i].y, "red");
                if (
                    player.x < enemies[i].x + 50 &&
                    player.x + 50 > enemies[i].x &&
                    player.y < enemies[i].y + 80 &&
                    player.y + 80 > enemies[i].y
                ) {
                    gameOver = true;
                    alert("Game Over! Score: " + score);
                    return;
                }
            }

            enemies = enemies.filter(e => e.x + 80 > cameraX);
            if (Math.random() < 0.02) {
                let lane = lanes[Math.floor(Math.random() * lanes.length)];
                enemies.push({ x: cameraX + canvas.width, y: lane });
                score++;
            }

            cameraX = player.x - 200;
            requestAnimationFrame(update);
        }

        document.addEventListener("keydown", function(event) {
            keys[event.key] = true;
        });

        document.addEventListener("keyup", function(event) {
            keys[event.key] = false;
        });

        window.addEventListener("resize", () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            laneHeight = canvas.height / 3;
            lanes = [laneHeight / 2, laneHeight * 1.5, laneHeight * 2.5];
        });

        update();
    </script>
</body>
</html>
